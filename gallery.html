<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8" />
	<link rel="apple-touch-icon" sizes="76x76" href="./assets/img/logo.svg">
	<link rel="icon" type="image/png" href="./assets/img/logo.svg">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<title>I2ML-南京航空航天大学I2ML实验室</title>
	<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no'
		name='viewport' />
	<!-- Google Font -->
	<link href="https://fonts.googleapis.com/css?family=Playfair+Display:400,700|Source+Sans+Pro:400,600,700"
		rel="stylesheet">
	<!-- Font Awesome Icons -->
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css"
		integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
	<!-- Main CSS -->
	<link href="./assets/css/main.css" rel="stylesheet" />
	<link href="./assets/css/custom.css" rel="stylesheet" />
	<style>
		.lds-ellipsis {
			display: inline-block;
			position: relative;
			width: 80px;
			height: 80px;
		}

		.lds-ellipsis div {
			position: absolute;
			top: 33px;
			width: 13px;
			height: 13px;
			border-radius: 50%;
			background: #347dff;
			animation-timing-function: cubic-bezier(0, 1, 1, 0);
		}

		.lds-ellipsis div:nth-child(1) {
			left: 8px;
			animation: lds-ellipsis1 0.6s infinite;
		}

		.lds-ellipsis div:nth-child(2) {
			left: 8px;
			animation: lds-ellipsis2 0.6s infinite;
		}

		.lds-ellipsis div:nth-child(3) {
			left: 32px;
			animation: lds-ellipsis2 0.6s infinite;
		}

		.lds-ellipsis div:nth-child(4) {
			left: 56px;
			animation: lds-ellipsis3 0.6s infinite;
		}

		@keyframes lds-ellipsis1 {
			0% {
				transform: scale(0);
			}

			100% {
				transform: scale(1);
			}
		}

		@keyframes lds-ellipsis3 {
			0% {
				transform: scale(1);
			}

			100% {
				transform: scale(0);
			}
		}

		@keyframes lds-ellipsis2 {
			0% {
				transform: translate(0, 0);
			}

			100% {
				transform: translate(24px, 0);
			}
		}
	</style>
</head>

<body>
	<!--------------------------------------
NAVBAR
--------------------------------------->
	<nav class="topnav navbar navbar-expand-sm navbar-light bg-white fixed-top">
		<div class="container">
			<a class="navbar-brand" href="./index.html"><strong>I2ML</strong></a>
			<button class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#navbarColor02"
				aria-controls="navbarColor02" aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="navbar-collapse collapse" id="navbarColor02">
				<ul class="navbar-nav mr-auto d-flex align-items-center">
					<li class="nav-item">
						<a class="nav-link" href="./members.html">Members</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="./news.html">News</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="./publications.html">Publications</a>
					</li>
					<li class="nav-item">
						<a class="nav-link border-bottom border-primary" href="./gallery.html">Gallery</a>
					</li>
				</ul>
				<ul class="navbar-nav ml-auto d-flex align-items-center">
					<li class="nav-item highlight d-none d-md-block">
						<div
							style="background-image: url(./assets/img/NUAA.png); height: 36px; width:200px; background-position: right; background-size: contain;    background-repeat: no-repeat;">
						</div>
					</li>
				</ul>
			</div>
		</div>
	</nav>
	<!-- End Navbar -->


	<!--------------------------------------
HEADER
--------------------------------------->


	<!--------------------------------------
MAIN
--------------------------------------->
	<div class="container">
		<div style="min-height: 700px;">
			<div class="row" id="waterfall_wrapper"></div>
			<div class="text-center" id="waterfall_spinner">
				<div class="lds-ellipsis"><div></div><div></div><div></div><div></div></div>
			</div>
		</div>
	</div>



	<!--------------------------------------
FOOTER
--------------------------------------->
	<div class="container pt-4 pb-4">
		<div class="row">
			<div class="col-sm-12 col-md-4 col-xl-3 text-sm-center">
				<div class="card border-0 box-shadow">
					<div
						style="background-image: url(./assets/img/wechat.png); height: 100px; background-position: center; background-size: contain;    background-repeat: no-repeat;">
					</div>
				</div>
			</div>
			<div class="col-sm-12 col-md-8 col-xl-9 text-md-left text-center">
				<p class="mb-0"><small class="text-muted">Related Links:</small></p>
				<p class="mb-0">
					<a class="mr-2" href="https://github.com/I2-Multimedia-Lab" target="_blank"><small
							class="text-muted">Our github: I2-Multimedia-Lab</small></a>
				</p>
				<p class="mb-0">
					<a class="mr-2" href="http://nuaa.edu.cn" target="_blank"><small class="text-muted">Nanjing
							University of Aeronautics and Astronautics</small></a>
				</p>
				<p class="mb-0">
					<a class="mr-2" href="http://cs.nuaa.edu.cn" target="_blank"><small class="text-muted">College of
							Computer Science and Technology/College of Artificial Intelligence</small></a>
				</p>
			</div>
		</div>
	</div>

	<div class="container">
		<footer class="bg-white border-top pt-3 pb-3 text-muted small">
			<div class="row align-items-center justify-content-between">
				<div class="col-12 col-lg-6 text-center text-lg-left">
					Copyright &copy;
					<script>document.write(new Date().getFullYear())</script>.
					南京航空航天大学. All rights reserved.
				</div>
				<div class="col-12 col-lg-6 text-center text-lg-right">
					Made with <a target="_blank" class="text-primary font-weight-bold"
						href="https://www.wowthemes.net/mundana-free-html-bootstrap-template/">Mundana Theme</a> by
					WowThemes.net
				</div>
			</div>
		</footer>
	</div>
	<!-- End Footer -->

	<!--------------------------------------
JAVASCRIPTS
--------------------------------------->
	<script src="./assets/js/vendor/jquery.min.js" type="text/javascript"></script>
	<script src="./assets/js/vendor/popper.min.js" type="text/javascript"></script>
	<script src="./assets/js/vendor/bootstrap.min.js" type="text/javascript"></script>
	<script src="./assets/js/function.js" type="text/javascript"></script>

	<!--------------------------------------
Js写入 -- Members
--------------------------------------->
	<script src="./contents/config.js" type="text/javascript"></script>
	<script src="./contents/gallery.js" type="text/javascript"></script>
	<script>

		// 对于电脑和手机，使用两种不同的加载策略
		vw = $(window).width()
		mobile_mode = (vw < 960)
		
		if(mobile_mode){
			$('#waterfall_wrapper').html('<div class="col-6 waterfall"></div>\
											<div class="col-6 waterfall"></div>')
		}else{
			// 如果是电脑，则四列加载
			$('#waterfall_wrapper').html('<div class="col-3 waterfall"></div>\
											<div class="col-3 waterfall"></div>\
											<div class="col-3 waterfall"></div>\
											<div class="col-3 waterfall"></div>')
		}

		function getHeightOfChilden(jqobj){
			height = 0
			jqobj.find('.frame').each(function(){
				height += $(this).height()
			})
			return height
		}
		function sleep(ms) {
			return new Promise(resolve => setTimeout(resolve, ms));
		}

		async function loadPhotos(){
			$('#waterfall_spinner').show()
			total_photo_len = gallery.length
			for(i=0;i<total_photo_len;i++){
				item = gallery.shift()
				thumbnail = ''
				badge_html = ''
				if('thumbnail' in item){
					thumbnail = item.thumbnail
				}else{
					thumbnail = item.photo
				}
				for(label in item.labels){
					badge_html += '<span class="badge badge-pill bg-light mr-1">'+item.labels[label]+'</span>'
				}
				frame = $('<div class="frame mb-3">\
								<div class="photo_wrapper">\
									<img class="photo" src="'+thumbnail+'" onclick="jumpToImage(this)" link="'+item.photo+'">\
								</div>\
								<div class="labels">'+badge_html+'</div>\
							</div>')
				target_waterfall = {}
				min_height = 999999999
				$("#waterfall_wrapper .waterfall").each(function(){
					height = getHeightOfChilden($(this))
					console.log(height)
					if(height < min_height){
						target_waterfall = $(this)
						min_height = height
					}
				})
				// frame.hide()
				target_waterfall.append(frame)
				// frame.fadeIn(10)
				await sleep(10);
			}
			
			$('#waterfall_spinner').hide()
		}

		loadPhotos()

		// 点击时跳转
		function jumpToImage(imgObj){
			window.open($(imgObj).attr('link'))
		}
	</script>
</body>

</html>
